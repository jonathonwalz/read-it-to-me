var e,t,n="read-it-to-me-content-group",a="focusin",o=[],s=!0,i={play:null,pause:null,cancel:null,toggle:null},c=function(){r(),m(),sessionStorage.getItem("readItToMeDisabled")&&(t.querySelector("input.switch-input").checked=!1,d())},r=function(){var e=document.createElement("div");e.classList.add("read-it-to-me-control-bubble"),e.tabIndex=-1,e.innerHTML='<p class="read-it-to-me-label"></p><button type="button" class="play-pause-resume"></button><button type="button" class="cancel-audio"><span class="visually-hidden">Cancel audio</a></button>';var a=document.querySelectorAll(".".concat(n)),o=document.createElement("div");o.classList.add("read-this-to-me"),a.forEach(function(t){var a=o.cloneNode(!1);for(t.appendChild(a);t.firstChild!==a;)a.appendChild(t.firstChild);var i=e.cloneNode(!0);i.addEventListener("focusin",l(t)),i.addEventListener("focusout",u(t)),i.querySelector("button.play-pause-resume").addEventListener("click",function(e){if(!s)return!1;e.stopPropagation();var t=e.target.closest(".".concat(n));g(t)}),i.querySelector("button.cancel-audio").addEventListener("click",h(i)),t.insertBefore(i,a)}),(t=document.createElement("div")).classList.add("read-it-to-me-control-bar"),t.setAttribute("tabindex","0"),t.setAttribute("aria-describedby","ritm-sr-message"),t.innerHTML='<div class="toggle-wrapper">\n                            <p class="visually-hidden" id="ritm-sr-message">Screen-reader users: there is a rudimentary "on-demand" read-aloud feature in use on this page called "Read-it-to-Me".  This new feature, which isn\'t meant as a screen-reader alternative, adds more tabable areas in the document which are great for keyboard users not using screen-readers, but are likely to be annoying for you. You can toggle off/on "Read-it-to-Me" using this checkbox.</p>\n                            <p class="read-it-to-me-label">Toggle Read-it-to-Me</p>\n                            <label class="switch" aria-label="Toggle Read-it-to-Me." aria-describedby="ritm-sr-message">\n                              <input type="checkbox" class="switch-input" checked>\n                              <span class="switch-outline"></span>\n                              <span class="switch-label" data-on="On" data-off="Off"></span>\n                              <span class="switch-handle"></span>\n                            </label>\n                          </div>\n                          <div class="cancel-audio-wrapper">\n                            <button type="button" class="btn btn-default btn-lg">Cancel audio</button>\n                          </div>';var i=document.body;i.insertBefore(t,i.firstChild)},l=function(e){return function(t){if(!s)return!1;t.stopPropagation(),e.classList.add(a)}},u=function(e){return function(t){t.stopPropagation(),e.classList.remove(a)}},d=function(o){var c,r=o?o.target:t.querySelector("input.switch-input"),l=document.querySelectorAll(".".concat(n));r.checked?(s=!0,sessionStorage.removeItem("readItToMeDisabled"),l.forEach(function(e){e.classList.remove("ritm-disabled")})):(s=!1,(c=document.querySelector(".".concat(a)))&&c.classList.remove(a),e.cancel(),sessionStorage.setItem("readItToMeDisabled","1"),l.forEach(function(e){e.classList.add("ritm-disabled"),e.classList.contains("ritm-do-not-strip-tabindex")||e.removeAttribute("tabindex")})),o&&i.toggle&&i.toggle()},p=function(e){e.target&&t.contains(e.target)&&(t.classList.contains("control-bar-show")||b())},f=function(e){(e.relatedTarget&&!t.contains(e.relatedTarget)||!e.relatedTarget)&&v()},h=function(e){return function(){if(i.cancel)try{i.cancel()}catch(e){}e.contains(this)&&e.focus(),T()}},m=function(){t.querySelector("button").addEventListener("click",h(t)),t.querySelector("input.switch-input").addEventListener("change",d),t.addEventListener("focusin",p),t.addEventListener("focusout",f)},g=function(e){e.classList.contains("read-it-to-me-play")||e.classList.contains("read-it-to-me-pause")?e.classList.contains("read-it-to-me-play")?(w(),e.classList.toggle("read-it-to-me-play"),e.classList.toggle("read-it-to-me-pause")):e.classList.contains("read-it-to-me-pause")&&(E(),e.classList.toggle("read-it-to-me-play"),e.classList.toggle("read-it-to-me-pause")):(o.push(e),document.querySelectorAll(".read-it-to-me-play").length>0||document.querySelectorAll(".read-it-to-me-pause").length>0?T():S(),e.classList.toggle("read-it-to-me-play"))},y=function(){t.classList.remove("show-ritm-cancel")},b=function(){t.classList.add("control-bar-show")},v=function(){t.classList.remove("control-bar-show")},L=function(){var e;o.length>0&&((e=o[0]).classList.remove("read-it-to-me-play"),e.classList.remove("read-it-to-me-pause"),v(),y(),o.shift()),o.length>0&&S()},S=function(){var n,a,s=(n=o[0].querySelector(".read-this-to-me"),(a=n.cloneNode(!0)).querySelectorAll("p, li, abbr, strong, em, h1, h2, h3, h4, h5, h6").forEach(function(e){var t=e.tagName.toUpperCase();if("P"===t)e.appendChild(document.createTextNode(". "));else if("ABBR"===t){var n=e.textContent.split("");e.textContent=n.join(".")}else"STRONG"===t||"EM"===t?(e.insertBefore(document.createTextNode(", "),e.firstChild),e.appendChild(document.createTextNode(", "))):"LI"===t?e.appendChild(document.createTextNode(", ")):"H1"!==t&&"H2"!==t&&"H3"!==t&&"H4"!==t&&"H5"!==t&&"H6"!==t||e.appendChild(document.createTextNode(", "))}),a.textContent);e.play({text:s},L),t.classList.add("show-ritm-cancel"),b(),i.play&&i.play()},w=function(){e.pause(),i.pause&&i.pause()},E=function(){e.resume()},T=function(){y(),e.cancel()};function q(t){(t&&document.querySelectorAll(t).length>0||document.querySelectorAll(".".concat(n)).length>0)&&function(e,t){var n=[],a=!1;if(e||"undefined"==typeof speechSynthesis||(e=speechSynthesis),e){var o={play:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=new SpeechSynthesisUtterance(t.text);if(o.lang="en-US",o.rate=.8,n.length>0)for(var s=0;s<n.length;s++)if(0===n[s].lang.indexOf("en")&&"Samantha"===n[s].name){o.voice=n[s];break}o.onend=function(){return a(null,t)},o.onerror=function(e){setTimeout(function(){return a(e.error||new Error("Unknown speech synthesis error"),t)},100)},e.speak(o)},pause:function(){e.pause()},resume:function(){e.resume()},cancel:function(){e.cancel()}};0===(n=e.getVoices()).length&&(void 0!==e.onvoiceschanged?e.onvoiceschanged=function(){n=e.getVoices(),t(null,o)}:a=!0),e.cancel(),!n.length&&a?t(new Error("Unable to load voice list")):n.length&&t(null,o)}else t(new Error("Speech Synthesis is unavailable."))}(void 0,function(o,s){!o&&s?(e=s,t&&document.querySelectorAll(t).length>0&&document.querySelectorAll(t).forEach(function(e){e.classList.add(n)}),c()):document.querySelectorAll(".".concat(n)).forEach(function(e){e.classList.remove(n,a)})})}function x(){return s}function k(){return!(!o[0]||!o[0].dataset.ritmOptionalTrackingIdentifier||""===o[0].dataset.ritmOptionalTrackingIdentifier)&&o[0].dataset.ritmOptionalTrackingIdentifier}function C(e){e&&(e.play&&"function"==typeof e.play&&(i.play=e.play),e.pause&&"function"==typeof e.pause&&(i.pause=e.pause),e.cancel&&"function"==typeof e.cancel&&(i.cancel=e.cancel),e.toggle&&"function"==typeof e.toggle&&(i.toggle=e.toggle))}export{k as currentUtteranceIdentifier,C as eventTracking,q as init,x as isEnabled};
//# sourceMappingURL=read-it-to-me.esm.js.map
