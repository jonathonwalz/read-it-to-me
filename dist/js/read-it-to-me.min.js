"use strict";var ReadItToMe=function(){var e=this,o=window.speechSynthesis,a="ritm-disabled",i="read-it-to-me-content-group",r="focusin",s=[],c=void 0,l=void 0,d=[],u=void 0,f=void 0,p=!0,m={play:null,pause:null,cancel:null,toggle:null},h=function(e){e.hasAttribute("tabindex")?e.classList.contains("ritm-do-not-strip-tabindex")||e.classList.add("ritm-do-not-strip-tabindex"):e.setAttribute("tabindex","0")},t=function(){var e=document.querySelectorAll("."+i),n=document.createElement("div");n.classList.add("read-this-to-me"),e.forEach(function(e){var t=n.cloneNode(!1);for(e.appendChild(t);e.firstChild!==t;)t.appendChild(e.firstChild)}),(c=document.createElement("div")).classList.add("read-it-to-me-control-bubble"),c.innerHTML='<p class="read-it-to-me-label"></p><button type="button" class="play-pause-resume"></button><button type="button" class="cancel-audio"><span class="visually-hidden">Cancel audio</a></button>',(l=document.createElement("div")).classList.add("read-it-to-me-control-bar"),l.setAttribute("tabindex","0"),l.setAttribute("aria-describedby","ritm-sr-message"),l.innerHTML='<div class="toggle-wrapper">\n                              <p class="visually-hidden" id="ritm-sr-message">Screen-reader users: there is a rudimentary "on-demand" read-aloud feature in use on this page called "Read-it-to-Me".  This new feature, which isn\'t meant as a screen-reader alternative, adds more tabable areas in the document which are great for keyboard users not using screen-readers, but are likely to be annoying for you. You can toggle off/on "Read-it-to-Me" using this checkbox.</p>\n                              <p class="read-it-to-me-label">Toggle Read-it-to-Me</p>\n                              <label class="switch" aria-label="Toggle Read-it-to-Me." aria-describedby="ritm-sr-message">\n                                <input type="checkbox" class="switch-input" checked>\n                                <span class="switch-outline"></span>\n                                <span class="switch-label" data-on="On" data-off="Off"></span>\n                                <span class="switch-handle"></span>\n                              </label>\n                            </div>\n                            <div class="cancel-audio-wrapper">\n                              <button type="button" class="btn btn-default btn-lg">Cancel audio</button>\n                            </div>';var t=document.body;t.insertBefore(l,t.firstChild),t.appendChild(c)},b=function(e){if(c.parentNode!==e)try{e.insertBefore(c,e.firstChild)}catch(e){}},g=function(){try{document.body.appendChild(c)}catch(e){}},y=function(){var e=document.querySelector("."+r);e&&e.classList.remove(r)},n=function(e){if(!p)return!1;y();var t=e.target;t&&t.matches("."+i)&&!t.querySelector(".read-it-to-me-control-bubble")&&b(t)},v=function(e){if(!p)return!1;var t=e.relatedTarget?e.relatedTarget.closest("."+i):null;t?b(t):g()},L=function(e){if(!p)return!1;e.stopPropagation();var t=e.target,n=e.relatedTarget,a=void 0;if(t&&t.matches("."+i)&&(a=!(!n||t.firstChild.querySelector("button")!==n),t.classList.contains(r)||t.classList.add(r),t.querySelector(".read-it-to-me-control-bubble")||b(t),!a)){var o=window.scrollY;t.firstChild.querySelector("button").focus(),window.scroll(0,o)}},S=function(e){if(!p)return!1;e.stopPropagation();var t=e.target,n=e.relatedTarget;if(t&&n){if(t.matches("."+i)&&n.matches(".read-it-to-me-control-bubble button")&&t.contains(n))return!1;if(t.matches(".read-it-to-me-control-bubble button")&&n.matches("."+i)&&n.contains(t))return!1;if(t.matches(".read-it-to-me-control-bubble button")&&n.matches(".read-it-to-me-control-bubble button"))return!1;(t.matches("."+i)?t:t.closest("."+i)).classList.remove(r),g()}},w=function(e){var t=e?e.target:l.querySelector("input.switch-input"),n=document.querySelectorAll("."+i);t.checked?(p=!0,sessionStorage.removeItem("readItToMeDisabled"),n.forEach(function(e){e.classList.remove(a),h(e)})):(p=!1,y(),o.cancel(),sessionStorage.setItem("readItToMeDisabled","1"),n.forEach(function(e){e.classList.add(a),e.classList.contains("ritm-do-not-strip-tabindex")||e.removeAttribute("tabindex")})),e&&m.toggle&&m.toggle()},T=function(e){e.target&&l.contains(e.target)&&(l.classList.contains("control-bar-show")||A())},E=function(e){(e.relatedTarget&&!l.contains(e.relatedTarget)||!e.relatedTarget)&&I()},q=function(){if(m.cancel)try{m.cancel()}catch(e){}l.contains(e)&&l.focus(),c.contains(e)&&c.focus(),R()},C=function(){c.querySelector("button.play-pause-resume").addEventListener("click",function(e){if(!p)return!1;e.stopPropagation();var t=e.target.closest("."+i);x(t)}),c.querySelector("button.cancel-audio").addEventListener("click",q),l.querySelector("button").addEventListener("click",q),l.querySelector("input.switch-input").addEventListener("change",w),l.addEventListener("focusin",T),l.addEventListener("focusout",E),document.querySelectorAll("."+i).forEach(function(e){e.addEventListener("mouseenter",n),e.addEventListener("click",n),e.addEventListener("mouseleave",v),e.addEventListener("focusin",L),e.addEventListener("focusout",S)}),o.cancel()},x=function(e){e.classList.contains("read-it-to-me-play")||e.classList.contains("read-it-to-me-pause")?e.classList.contains("read-it-to-me-play")?(H(),e.classList.toggle("read-it-to-me-play"),e.classList.toggle("read-it-to-me-pause")):e.classList.contains("read-it-to-me-pause")&&(O(),e.classList.toggle("read-it-to-me-play"),e.classList.toggle("read-it-to-me-pause")):(s.push(e),0<document.querySelectorAll(".read-it-to-me-play").length||0<document.querySelectorAll(".read-it-to-me-pause").length?R():N(),e.classList.toggle("read-it-to-me-play"))},k=function(){l.classList.remove("show-ritm-cancel")},A=function(){l.classList.add("control-bar-show")},I=function(){l.classList.remove("control-bar-show")},M=function(){var e;0<s.length&&((e=s[0]).classList.remove("read-it-to-me-play"),e.classList.remove("read-it-to-me-pause"),I(),k(),s.shift()),0<s.length&&N(),f=null},N=function(){var e,t,n=(e=s[0].querySelector(".read-this-to-me"),(t=e.cloneNode(!0)).querySelectorAll("p, li, abbr, strong, em, h1, h2, h3, h4, h5, h6").forEach(function(e){var t=e.tagName.toUpperCase();if("P"===t)e.appendChild(document.createTextNode(". "));else if("ABBR"===t){var n=e.textContent.split("");e.textContent=n.join(".")}else"STRONG"===t||"EM"===t?(e.insertBefore(document.createTextNode(", "),e.firstChild),e.appendChild(document.createTextNode(", "))):"LI"===t?e.appendChild(document.createTextNode(", ")):"H1"!==t&&"H2"!==t&&"H3"!==t&&"H4"!==t&&"H5"!==t&&"H6"!==t||e.appendChild(document.createTextNode(", "))}),t.textContent);if((u=new SpeechSynthesisUtterance(n)).lang="en-US",u.rate=.8,0<d.length)for(var a=0;a<d.length;a++)if(0===d[a].lang.indexOf("en")&&"Samantha"===d[a].name){u.voice=d[a];break}u.onend=M,u.onerror=function(){f||(f=window.setTimeout(M,100))},o.speak(u),l.classList.add("show-ritm-cancel"),A(),m.play&&m.play()},H=function(){o.pause(),m.pause&&m.pause()},O=function(){o.resume()},R=function(){k(),o.cancel()};return{init:function(e){o?(e&&0<document.querySelectorAll(e).length&&document.querySelectorAll(e).forEach(function(e){e.classList.add(i)}),document.querySelectorAll("."+i).forEach(function(e){h(e)}),document.querySelectorAll("."+i)&&(0===(d=o.getVoices()).length&&void 0!==o.onvoiceschanged&&(o.onvoiceschanged=function(){d=o.getVoices()}),t(),C(),sessionStorage.getItem("readItToMeDisabled")&&(l.querySelector("input.switch-input").checked=!1,w()))):document.querySelectorAll("."+i).forEach(function(e){e.classList.remove(i,r)})},isEnabled:function(){return p},currentUtteranceIdentifier:function(){return!(!s[0]||!s[0].dataset.ritmOptionalTrackingIdentifier||""===s[0].dataset.ritmOptionalTrackingIdentifier)&&s[0].dataset.ritmOptionalTrackingIdentifier},eventTracking:function(e){e&&(e.play&&"function"==typeof e.play&&(m.play=e.play),e.pause&&"function"==typeof e.pause&&(m.pause=e.pause),e.cancel&&"function"==typeof e.cancel&&(m.cancel=e.cancel),e.toggle&&"function"==typeof e.toggle&&(m.toggle=e.toggle))}}}();